import{j as e,Y as D,a5 as $,X as k,r as H,p as L,o as I,s as R,t as U}from"./ui-Bqq2ZByQ.js";import{r as o}from"./vendor-OvZ-gMQr.js";import{L as B,d as G}from"./index-BZ3NqF2W.js";import{w as _,v as q,B as z,D as O,m as X}from"./firebase-BCjCWirw.js";import{G as Y}from"./spotlight-card-DVeApegc.js";import{u as J}from"./router-DzlXm3yj.js";import"./utils-CjxovF-h.js";const K=({onSearch:x,onFilterChange:N,availableTypes:P})=>{const[p,v]=o.useState(""),[g,n]=o.useState(!1),[l,m]=o.useState({type:"",minPrice:0,maxPrice:0,date:"",time:""}),T=r=>{v(r),x(r)},s=(r,c)=>{const w={...l,[r]:c};m(w),N(w)},S=()=>{const r={type:"",minPrice:0,maxPrice:0,date:"",time:""};m(r),N(r)},b=l.type||l.minPrice>0||l.maxPrice>0||l.date||l.time,d=[];for(let r=6;r<=22;r++){const c=r>12?`${r-12}:00 PM`:r===12?"12:00 PM":`${r}:00 AM`;d.push(c)}return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-4 sm:p-6 mb-8",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(D,{className:"h-5 w-5 text-gray-400 dark:text-gray-500"})}),e.jsx("input",{type:"text",placeholder:"Search cards by title, type, or location...",value:p,onChange:r=>T(r.target.value),className:"block w-full pl-10 pr-3 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm sm:text-base bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"})]}),e.jsxs("button",{onClick:()=>n(!g),className:`flex items-center px-4 py-3 border rounded-lg transition-colors duration-200 text-sm sm:text-base ${g||b?"bg-blue-600 text-white border-blue-600":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600"}`,children:[e.jsx($,{className:"w-5 h-5 mr-2"}),"Filters",b&&e.jsx("span",{className:"ml-2 bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold",children:"!"})]})]}),g&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Filters"}),b&&e.jsxs("button",{onClick:S,className:"text-sm text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 flex items-center",children:[e.jsx(k,{className:"w-4 h-4 mr-1"}),"Clear all"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Sport Type"}),e.jsxs("select",{value:l.type,onChange:r=>s("type",r.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"",children:"All Types"}),P.map(r=>e.jsx("option",{value:r,children:r},r))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 flex items-center",children:[e.jsx(H,{className:"w-4 h-4 mr-1"}),"Date"]}),e.jsx("input",{type:"date",value:l.date,onChange:r=>s("date",r.target.value),min:new Date().toISOString().split("T")[0],className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 flex items-center",children:[e.jsx(L,{className:"w-4 h-4 mr-1"}),"Time"]}),e.jsxs("select",{value:l.time,onChange:r=>s("time",r.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"",children:"Any Time"}),d.map(r=>e.jsx("option",{value:r,children:r},r))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Min Price (₹/hour)"}),e.jsx("input",{type:"number",value:l.minPrice||"",onChange:r=>s("minPrice",parseInt(r.target.value)||0),placeholder:"0",min:"0",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Max Price (₹/hour)"}),e.jsx("input",{type:"number",value:l.maxPrice||"",onChange:r=>s("maxPrice",parseInt(r.target.value)||0),placeholder:"Any",min:"0",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"})]})]}),b&&e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[l.type&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300",children:["Type: ",l.type,e.jsx("button",{onClick:()=>s("type",""),className:"ml-2 text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300",children:e.jsx(k,{className:"w-3 h-3"})})]}),l.date&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-purple-100 dark:bg-purple-900/30 text-purple-800 dark:text-purple-300",children:["Date: ",new Date(l.date).toLocaleDateString(),e.jsx("button",{onClick:()=>s("date",""),className:"ml-2 text-purple-600 dark:text-purple-400 hover:text-purple-800 dark:hover:text-purple-300",children:e.jsx(k,{className:"w-3 h-3"})})]}),l.time&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-orange-100 dark:bg-orange-900/30 text-orange-800 dark:text-orange-300",children:["Time: ",l.time,e.jsx("button",{onClick:()=>s("time",""),className:"ml-2 text-orange-600 dark:text-orange-400 hover:text-orange-800 dark:hover:text-orange-300",children:e.jsx(k,{className:"w-3 h-3"})})]}),l.minPrice>0&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300",children:["Min: ₹",l.minPrice,e.jsx("button",{onClick:()=>s("minPrice",0),className:"ml-2 text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300",children:e.jsx(k,{className:"w-3 h-3"})})]}),l.maxPrice>0&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300",children:["Max: ₹",l.maxPrice,e.jsx("button",{onClick:()=>s("maxPrice",0),className:"ml-2 text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300",children:e.jsx(k,{className:"w-3 h-3"})})]})]})]})]})},j=9;function se(){const[x,N]=o.useState([]),[P,p]=o.useState(!0),[v,g]=o.useState(""),[n,l]=o.useState(1),[m,T]=o.useState(""),[s,S]=o.useState({type:"",minPrice:0,maxPrice:0,date:"",time:""}),b=J(),d=o.useMemo(()=>{let t=x;if(m){const a=m.toLowerCase();t=t.filter(i=>i.title.toLowerCase().includes(a)||i.type.toLowerCase().includes(a)||i.location?.toLowerCase().includes(a)||i.description?.toLowerCase().includes(a))}return s.type&&(t=t.filter(a=>a.type===s.type)),s.minPrice>0&&(t=t.filter(a=>a.pricePerHour>=s.minPrice)),s.maxPrice>0&&(t=t.filter(a=>a.pricePerHour<=s.maxPrice)),s.time&&(t=t.filter(a=>{if(!a.openingTime||!a.closingTime)return!0;const i=u=>{const[y,h]=u.split(" "),[f,C]=y.split(":").map(Number);let F=f;return h?.toUpperCase()==="PM"&&f!==12?F+=12:h?.toUpperCase()==="AM"&&f===12&&(F=0),F*60+(C||0)};try{const u=i(s.time),y=i(a.openingTime),h=i(a.closingTime);return u>=y&&u<h}catch{return!0}})),t},[x,m,s]),r=o.useMemo(()=>{const t=(n-1)*j,a=t+j;return d.slice(t,a)},[d,n]),c=Math.ceil(d.length/j),w=o.useMemo(()=>[...new Set(x.map(t=>t.type))].filter(Boolean),[x]);o.useEffect(()=>{let t=null,a=null;const u=setTimeout(()=>{try{p(!0),g("");const y=_(q(G,"cards"),z("createdAt","desc"),O(50));t=X(y,h=>{const f=[];h.forEach(C=>{f.push({id:C.id,...C.data()})}),a&&clearTimeout(a),a=setTimeout(()=>{N(f),p(!1)},100)},h=>{g("Unable to load community cards at the moment."),p(!1)})}catch{g("Unable to load community cards at the moment."),p(!1)}},100);return()=>{t&&t(),a&&clearTimeout(a),clearTimeout(u)}},[]),o.useEffect(()=>{l(1)},[m,s]);const M=t=>{t>=1&&t<=c&&l(t)},A=t=>{T(t)},E=t=>{S(t)};return P&&x.length===0?e.jsxs("div",{className:"mb-12",children:[e.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white mb-6",children:"Community Cards"}),e.jsx(B,{size:"md",className:"py-12"})]}):v?e.jsxs("div",{className:"mb-12",children:[e.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white mb-6",children:"Community Cards"}),e.jsxs("div",{className:"bg-yellow-100 dark:bg-yellow-900/30 border border-yellow-400 dark:border-yellow-600 text-yellow-700 dark:text-yellow-300 px-4 py-3 rounded-lg",children:[e.jsx("p",{children:v}),e.jsx("p",{className:"text-sm mt-1",children:"Please try refreshing the page or contact support if the issue persists."})]})]}):e.jsxs("div",{className:"mb-12 mt-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-6 space-y-4 sm:space-y-0",children:[e.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white",children:"Community Cards"}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:d.length>0?e.jsxs(e.Fragment,{children:["Showing ",(n-1)*j+1,"-",Math.min(n*j,d.length)," of ",d.length," cards"]}):e.jsx(e.Fragment,{children:"No cards found"})})]}),e.jsx(K,{onSearch:A,onFilterChange:E,availableTypes:w}),d.length===0?e.jsxs("div",{className:"text-center py-12 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-lg",children:m||s.type||s.minPrice>0||s.maxPrice>0||s.date||s.time?"No cards match your search criteria.":"No community cards available yet."}),e.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-sm mt-2",children:m||s.type||s.minPrice>0||s.maxPrice>0||s.date||s.time?"Try adjusting your search or filters.":"Be the first to create and share a card!"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-6 mb-4",children:r.map(t=>e.jsx(Y,{className:"cursor-pointer transition-transform duration-30 hover:scale-105",children:e.jsxs("div",{onClick:()=>b(`/card/${t.id}`),children:[e.jsxs("div",{className:"relative h-48 bg-gray-200 dark:bg-gray-700",children:[e.jsx("img",{src:t.imageUrl,alt:t.title,className:"w-full h-full object-cover",loading:"lazy",decoding:"async",onError:a=>{const i=a.target;i.src="https://images.pexels.com/photos/3657154/pexels-photo-3657154.jpeg?auto=compress&cs=tinysrgb&w=400&h=300&dpr=1"}}),e.jsx("div",{className:"absolute top-2 left-2 bg-green-600 text-white px-2 py-1 rounded text-xs sm:text-sm",children:"Community"}),t.pricePerHour>0&&e.jsxs("div",{className:"absolute top-2 right-2 bg-blue-600 text-white px-2 py-1 rounded text-xs sm:text-sm font-semibold",children:["₹",t.pricePerHour,"/hr"]})]}),e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-gray-900 dark:text-white mb-2 line-clamp-1",children:t.title}),e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("span",{className:"inline-block bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300 text-xs sm:text-sm px-3 py-1 rounded-full",children:t.type})}),t.location&&e.jsxs("div",{className:"flex items-center text-gray-600 dark:text-gray-400 text-sm mb-2",children:[e.jsx(I,{className:"w-4 h-4 mr-2 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:t.location})]}),t.pricePerHour>0&&e.jsx("div",{className:"flex items-center text-green-600 dark:text-green-400 text-sm mb-2",children:e.jsxs("span",{className:"font-semibold",children:["₹",t.pricePerHour," per hour"]})}),(t.openingTime||t.closingTime)&&e.jsxs("div",{className:"flex items-center text-gray-600 dark:text-gray-400 text-sm",children:[e.jsx(L,{className:"w-4 h-4 mr-2 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:t.openingTime&&t.closingTime?`${t.openingTime} - ${t.closingTime}`:t.openingTime||t.closingTime})]})]})]})},t.id))}),c>1&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center space-y-4 sm:space-y-0 sm:space-x-4",children:[e.jsxs("button",{onClick:()=>M(n-1),disabled:n===1,className:"flex items-center px-4 py-2 text-sm font-medium text-gray-500 dark:text-gray-400 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 hover:text-gray-700 dark:hover:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200",children:[e.jsx(R,{className:"w-4 h-4 mr-1"}),"Previous"]}),e.jsx("div",{className:"flex items-center space-x-2 overflow-x-auto",children:Array.from({length:Math.min(5,c)},(t,a)=>{let i;return c<=5||n<=3?i=a+1:n>=c-2?i=c-4+a:i=n-2+a,e.jsx("button",{onClick:()=>M(i),className:`px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 ${i===n?"bg-blue-600 text-white":"text-gray-500 dark:text-gray-400 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700 hover:text-gray-700 dark:hover:text-gray-300"}`,children:i},i)})}),e.jsxs("button",{onClick:()=>M(n+1),disabled:n===c,className:"flex items-center px-4 py-2 text-sm font-medium text-gray-500 dark:text-gray-400 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 hover:text-gray-700 dark:hover:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200",children:["Next",e.jsx(U,{className:"w-4 h-4 ml-1"})]})]})]})]})}export{se as default};
