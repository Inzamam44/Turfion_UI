import{L as q,g as O,_ as z}from"./index-C1saGSt8.js";import{j as e,s as G,Q as K,X as k,w as Q,i as _,h as V,K as X,N as J}from"./ui-DBnrXiOs.js";import{r as o,u as W}from"./router-us_BkMbn.js";import"./vendor-BYA32aEE.js";import"./firebase-CYC7APn9.js";const Y=({onSearch:m,onFilterChange:b,availableTypes:M})=>{const[u,w]=o.useState(""),[g,n]=o.useState(!1),[l,x]=o.useState({type:"",minPrice:0,maxPrice:0,date:"",time:""}),F=r=>{w(r),m(r)},s=(r,c)=>{const C={...l,[r]:c};x(C),b(C)},A=()=>{const r={type:"",minPrice:0,maxPrice:0,date:"",time:""};x(r),b(r)},y=l.type||l.minPrice>0||l.maxPrice>0||l.date||l.time,d=[];for(let r=6;r<=22;r++){const c=r>12?`${r-12}:00 PM`:r===12?"12:00 PM":`${r}:00 AM`;d.push(c)}return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-4 sm:p-6 mb-8",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(G,{className:"h-5 w-5 text-gray-400 dark:text-gray-500"})}),e.jsx("input",{type:"text",placeholder:"Search cards by title, type, or location...",value:u,onChange:r=>F(r.target.value),className:"block w-full pl-10 pr-3 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm sm:text-base bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"})]}),e.jsxs("button",{onClick:()=>n(!g),className:`flex items-center px-4 py-3 border rounded-lg transition-colors duration-200 text-sm sm:text-base ${g||y?"bg-blue-600 text-white border-blue-600":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600"}`,children:[e.jsx(K,{className:"w-5 h-5 mr-2"}),"Filters",y&&e.jsx("span",{className:"ml-2 bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold",children:"!"})]})]}),g&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Filters"}),y&&e.jsxs("button",{onClick:A,className:"text-sm text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 flex items-center",children:[e.jsx(k,{className:"w-4 h-4 mr-1"}),"Clear all"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Sport Type"}),e.jsxs("select",{value:l.type,onChange:r=>s("type",r.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"",children:"All Types"}),M.map(r=>e.jsx("option",{value:r,children:r},r))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 flex items-center",children:[e.jsx(Q,{className:"w-4 h-4 mr-1"}),"Date"]}),e.jsx("input",{type:"date",value:l.date,onChange:r=>s("date",r.target.value),min:new Date().toISOString().split("T")[0],className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 flex items-center",children:[e.jsx(_,{className:"w-4 h-4 mr-1"}),"Time"]}),e.jsxs("select",{value:l.time,onChange:r=>s("time",r.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"",children:"Any Time"}),d.map(r=>e.jsx("option",{value:r,children:r},r))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Min Price (₹/hour)"}),e.jsx("input",{type:"number",value:l.minPrice||"",onChange:r=>s("minPrice",parseInt(r.target.value)||0),placeholder:"0",min:"0",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Max Price (₹/hour)"}),e.jsx("input",{type:"number",value:l.maxPrice||"",onChange:r=>s("maxPrice",parseInt(r.target.value)||0),placeholder:"Any",min:"0",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"})]})]}),y&&e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[l.type&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300",children:["Type: ",l.type,e.jsx("button",{onClick:()=>s("type",""),className:"ml-2 text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300",children:e.jsx(k,{className:"w-3 h-3"})})]}),l.date&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-purple-100 dark:bg-purple-900/30 text-purple-800 dark:text-purple-300",children:["Date: ",new Date(l.date).toLocaleDateString(),e.jsx("button",{onClick:()=>s("date",""),className:"ml-2 text-purple-600 dark:text-purple-400 hover:text-purple-800 dark:hover:text-purple-300",children:e.jsx(k,{className:"w-3 h-3"})})]}),l.time&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-orange-100 dark:bg-orange-900/30 text-orange-800 dark:text-orange-300",children:["Time: ",l.time,e.jsx("button",{onClick:()=>s("time",""),className:"ml-2 text-orange-600 dark:text-orange-400 hover:text-orange-800 dark:hover:text-orange-300",children:e.jsx(k,{className:"w-3 h-3"})})]}),l.minPrice>0&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300",children:["Min: ₹",l.minPrice,e.jsx("button",{onClick:()=>s("minPrice",0),className:"ml-2 text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300",children:e.jsx(k,{className:"w-3 h-3"})})]}),l.maxPrice>0&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300",children:["Max: ₹",l.maxPrice,e.jsx("button",{onClick:()=>s("maxPrice",0),className:"ml-2 text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300",children:e.jsx(k,{className:"w-3 h-3"})})]})]})]})]})},Z=({children:m,className:b=""})=>e.jsx("div",{className:`rounded-2xl overflow-hidden bg-card/80 ${b}`,children:m}),N=9;function le(){const[m,b]=o.useState([]),[M,u]=o.useState(!0),[w,g]=o.useState(""),[n,l]=o.useState(1),[x,F]=o.useState(""),[s,A]=o.useState({type:"",minPrice:0,maxPrice:0,date:"",time:""}),y=W(),d=o.useMemo(()=>{let t=m;if(x){const a=x.toLowerCase();t=t.filter(i=>i.title.toLowerCase().includes(a)||i.type.toLowerCase().includes(a)||i.location?.toLowerCase().includes(a)||i.description?.toLowerCase().includes(a))}return s.type&&(t=t.filter(a=>a.type===s.type)),s.minPrice>0&&(t=t.filter(a=>a.pricePerHour>=s.minPrice)),s.maxPrice>0&&(t=t.filter(a=>a.pricePerHour<=s.maxPrice)),s.time&&(t=t.filter(a=>{if(!a.openingTime||!a.closingTime)return!0;const i=h=>{const[p,f]=h.split(" "),[j,E]=p.split(":").map(Number);let v=j;return f?.toUpperCase()==="PM"&&j!==12?v+=12:f?.toUpperCase()==="AM"&&j===12&&(v=0),v*60+(E||0)};try{const h=i(s.time),p=i(a.openingTime),f=i(a.closingTime);return h>=p&&h<f}catch{return!0}})),t},[m,x,s]),r=o.useMemo(()=>{const t=(n-1)*N,a=t+N;return d.slice(t,a)},[d,n]),c=Math.ceil(d.length/N),C=o.useMemo(()=>[...new Set(m.map(t=>t.type))].filter(Boolean),[m]);o.useEffect(()=>{let t=null,a=null;const h=setTimeout(async()=>{try{u(!0),g("");const p=await O();if(!p){g("Database not available"),u(!1);return}const{collection:f,onSnapshot:j,query:E,orderBy:v,limit:I}=await z(async()=>{const{collection:P,onSnapshot:T,query:S,orderBy:H,limit:B}=await import("./firebase-CYC7APn9.js").then(U=>U.B);return{collection:P,onSnapshot:T,query:S,orderBy:H,limit:B}},[]),R=E(f(p,"cards"),v("createdAt","desc"),I(50));t=j(R,P=>{const T=[];P.forEach(S=>{T.push({id:S.id,...S.data()})}),a&&clearTimeout(a),a=setTimeout(()=>{b(T),u(!1)},100)},P=>{g("Unable to load community cards at the moment."),u(!1)})}catch{g("Unable to load community cards at the moment."),u(!1)}},100);return()=>{t&&t(),a&&clearTimeout(a),clearTimeout(h)}},[]),o.useEffect(()=>{l(1)},[x,s]);const L=t=>{t>=1&&t<=c&&l(t)},D=t=>{F(t)},$=t=>{A(t)};return M&&m.length===0?e.jsxs("div",{className:"mb-12",children:[e.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white mb-6",children:"Community Cards"}),e.jsx(q,{size:"md",className:"py-12"})]}):w?e.jsxs("div",{className:"mb-12",children:[e.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white mb-6",children:"Community Cards"}),e.jsxs("div",{className:"bg-yellow-100 dark:bg-yellow-900/30 border border-yellow-400 dark:border-yellow-600 text-yellow-700 dark:text-yellow-300 px-4 py-3 rounded-lg",children:[e.jsx("p",{children:w}),e.jsx("p",{className:"text-sm mt-1",children:"Please try refreshing the page or contact support if the issue persists."})]})]}):e.jsxs("div",{className:"mb-12 mt-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-6 space-y-4 sm:space-y-0",children:[e.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white",children:"Community Cards"}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:d.length>0?e.jsxs(e.Fragment,{children:["Showing ",(n-1)*N+1,"-",Math.min(n*N,d.length)," of ",d.length," cards"]}):e.jsx(e.Fragment,{children:"No cards found"})})]}),e.jsx(Y,{onSearch:D,onFilterChange:$,availableTypes:C}),d.length===0?e.jsxs("div",{className:"text-center py-12 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-lg",children:x||s.type||s.minPrice>0||s.maxPrice>0||s.date||s.time?"No cards match your search criteria.":"No community cards available yet."}),e.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-sm mt-2",children:x||s.type||s.minPrice>0||s.maxPrice>0||s.date||s.time?"Try adjusting your search or filters.":"Be the first to create and share a card!"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-6 mb-4",children:r.map(t=>e.jsx(Z,{className:"cursor-pointer transition-transform duration-30 hover:scale-105",children:e.jsxs("div",{onClick:()=>y(`/card/${t.id}`),children:[e.jsxs("div",{className:"relative h-48 bg-gray-200 dark:bg-gray-700",children:[e.jsx("img",{src:t.imageUrl,alt:t.title,className:"w-full h-full object-cover",loading:"lazy",decoding:"async",onError:a=>{const i=a.target;i.src="https://images.pexels.com/photos/3657154/pexels-photo-3657154.jpeg?auto=compress&cs=tinysrgb&w=400&h=300&dpr=1"}}),e.jsx("div",{className:"absolute top-2 left-2 bg-green-600 text-white px-2 py-1 rounded text-xs sm:text-sm",children:"Community"}),t.pricePerHour>0&&e.jsxs("div",{className:"absolute top-2 right-2 bg-blue-600 text-white px-2 py-1 rounded text-xs sm:text-sm font-semibold",children:["₹",t.pricePerHour,"/hr"]})]}),e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-gray-900 dark:text-white mb-2 line-clamp-1",children:t.title}),e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("span",{className:"inline-block bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300 text-xs sm:text-sm px-3 py-1 rounded-full",children:t.type})}),t.location&&e.jsxs("div",{className:"flex items-center text-gray-600 dark:text-gray-400 text-sm mb-2",children:[e.jsx(V,{className:"w-4 h-4 mr-2 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:t.location})]}),t.pricePerHour>0&&e.jsx("div",{className:"flex items-center text-green-600 dark:text-green-400 text-sm mb-2",children:e.jsxs("span",{className:"font-semibold",children:["₹",t.pricePerHour," per hour"]})}),(t.openingTime||t.closingTime)&&e.jsxs("div",{className:"flex items-center text-gray-600 dark:text-gray-400 text-sm",children:[e.jsx(_,{className:"w-4 h-4 mr-2 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:t.openingTime&&t.closingTime?`${t.openingTime} - ${t.closingTime}`:t.openingTime||t.closingTime})]})]})]})},t.id))}),c>1&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center space-y-4 sm:space-y-0 sm:space-x-4",children:[e.jsxs("button",{onClick:()=>L(n-1),disabled:n===1,className:"flex items-center px-4 py-2 text-sm font-medium text-gray-500 dark:text-gray-400 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 hover:text-gray-700 dark:hover:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200",children:[e.jsx(X,{className:"w-4 h-4 mr-1"}),"Previous"]}),e.jsx("div",{className:"flex items-center space-x-2 overflow-x-auto",children:Array.from({length:Math.min(5,c)},(t,a)=>{let i;return c<=5||n<=3?i=a+1:n>=c-2?i=c-4+a:i=n-2+a,e.jsx("button",{onClick:()=>L(i),className:`px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 ${i===n?"bg-blue-600 text-white":"text-gray-500 dark:text-gray-400 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700 hover:text-gray-700 dark:hover:text-gray-300"}`,children:i},i)})}),e.jsxs("button",{onClick:()=>L(n+1),disabled:n===c,className:"flex items-center px-4 py-2 text-sm font-medium text-gray-500 dark:text-gray-400 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 hover:text-gray-700 dark:hover:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200",children:["Next",e.jsx(J,{className:"w-4 h-4 ml-1"})]})]})]})]})}export{le as default};
